<!DOCTYPE html>
<html>

<head>
    <title>Python to OpenAI function specification converter</title>
    <meta charset="utf-8">
    <style>
        .editor {
            width: 100%;
            height: 250px;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
            resize: vertical;
            font-family: Monaco, monospace;
            font-size: 14px;
        }

        .result {
            margin-top: 20px;
        }
    </style>
    <link rel="stylesheet" href="https://pyscript.net/latest/pyscript.css" />
    <script defer onload="console.log(`pyscript version: ${pyscript.version}`)"
        src="https://pyscript.net/latest/pyscript.js"></script>
</head>

<body>
    <h1>py2gpt<h1>
            <h2>Python to OpenAI function specification converter</h2>
            <script>
                const intervalTime = 1000;
                let lastVal = "";
                let isLoaded = false;

                function loadPyodideIfNeeded() {
                    if (!isLoaded) {
                        globalThis.loadPyodide();
                        isLoaded = true;
                    }
                }

                function validate() {
                    loadPyodideIfNeeded()
                    const editor = document.getElementById("editor");
                    const val = editor.value;
                    if (val !== lastVal) {
                        lastVal = val;
                        pyscript.interpreter.run("validate()");
                    }
                }

                setInterval(validate, intervalTime);
            </script>
            <textarea class="editor" id="editor" placeholder="Type in your function declaration here..."></textarea>
            <py-script src="main.py"></py-script>
            <iframe id="result" srcdoc="" style="width:100%;height:500px;"></iframe>

            <py-config>
                packages = ["docstring_parser", "rich"]
            </py-config>
</body>

</html>
